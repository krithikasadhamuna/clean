#!/usr/bin/env python3
"""
Comprehensive Unicode Fix Script for CodeGrey AI SOC Platform
This script removes all Unicode characters that cause encoding errors
"""

import os
import re
import sys
from pathlib import Path

def fix_unicode_in_file(file_path):
    """Fix Unicode characters in a single file"""
    try:
        with open(file_path, 'r', encoding='utf-8', errors='ignore') as f:
            content = f.read()
        
        # Common Unicode characters that cause issues
        unicode_replacements = {
            '': '',
            '': '',
            '': '',
            'WARNING:': 'WARNING:',
            '': '',
            '': '',
            '': '',
            '': '',
            '': '',
            '': '',
            '': '',
            'lightning': '',
            '': '',
            '': '',
            '': '',
            '': '',
            '': '',
            '': '',
            '': '',
            '': '',
            '': '',
            '': '',
            '': '',
            '': '',
            '': '',
            '': '',
            '': '',
            '': '',
            '': '',
            '': '',
            '': '',
            '': '',
            '': '',
            '': '',
            '-': '-',
            '->': '->',
            '*': '*',
            '->': '->',
            '|': '|',
            '-': '-',
            '+': '+',
            '+': '+',
            '+': '+',
            '+': '+',
            '+': '+',
            '+': '+',
            '+': '+',
            '+': '+',
            '+': '+',
            '.': '.',
            '.': '.',
            '.': '.',
            '#': '#',
            '.': '.',
            '.': '.',
            '|': '|',
            '|': '|',
            '#': '#',
            '[ ]': '[ ]',
            '^': '^',
            'v': 'v',
            '<': '<',
            '>': '>',
            '*': '*',
            '*': '*',
            '*': '*',
            '*': '*',
            'hearts': '<3',
            'diamonds': '<>',
            'clubs': 'clubs',
            'spades': 'spades',
            'note': '~',
            'notes': '~~',
            'sun': 'sun',
            'cloud': 'cloud',
            'umbrella': 'umbrella',
            'snowman': 'snowman',
            'comet': 'comet',
            '*': '*',
            '*': '*',
            'lightning': 'lightning',
            'thunder': 'thunder',
            'sun': 'sun',
            'ascending': 'ascending',
            'descending': 'descending',
            'conjunction': 'conjunction',
            'opposition': 'opposition',
            'phone': 'phone',
            'phone': 'phone',
            '[ ]': '[ ]',
            '[x]': '[x]',
            '[x]': '[x]',
            'x': 'x',
            'umbrella': 'umbrella',
            'coffee': 'coffee',
            'white': 'white',
            'black': 'black',
            'shamrock': 'shamrock',
            'reversed': 'reversed',
            'left': 'left',
            'right': 'right',
            'left': 'left',
            'up': 'up',
            'right': 'right',
            'down': 'down',
            'skull': 'skull',
            'warning': 'warning',
            'radioactive': 'radioactive',
            'biohazard': 'biohazard',
            'caduceus': 'caduceus',
            'ankh': 'ankh',
            'orthodox': 'orthodox',
            'chi-rho': 'chi-rho',
            'cross': 'cross',
            'cross': 'cross',
            'star-crescent': 'star-crescent',
            'farsi': 'farsi',
            'adisham': 'adisham',
            'hammer-sickle': 'hammer-sickle',
            'peace': 'peace',
            'yin-yang': 'yin-yang',
            'qian': 'qian',
            'dui': 'dui',
            'li': 'li',
            'zhen': 'zhen',
            'xun': 'xun',
            'kan': 'kan',
            'gen': 'gen',
            'kun': 'kun',
            'wheel': 'wheel',
            'frown': 'frown',
            'smile': 'smile',
            'smile': 'smile',
            'sun': 'sun',
            'moon': 'moon',
            'moon': 'moon',
            'mercury': 'mercury',
            'female': 'female',
            'earth': 'earth',
            'male': 'male',
            'jupiter': 'jupiter',
            'saturn': 'saturn',
            'uranus': 'uranus',
            'neptune': 'neptune',
            'pluto': 'pluto',
            'aries': 'aries',
            'taurus': 'taurus',
            'gemini': 'gemini',
            'cancer': 'cancer',
            'leo': 'leo',
            'virgo': 'virgo',
            'libra': 'libra',
            'scorpio': 'scorpio',
            'sagittarius': 'sagittarius',
            'capricorn': 'capricorn',
            'aquarius': 'aquarius',
            'pisces': 'pisces',
            'king': 'king',
            'queen': 'queen',
            'rook': 'rook',
            'bishop': 'bishop',
            'knight': 'knight',
            'pawn': 'pawn',
            'king': 'king',
            'queen': 'queen',
            'rook': 'rook',
            'bishop': 'bishop',
            'knight': 'knight',
            'pawn': 'pawn',
            'spades': 'spades',
            'hearts': 'hearts',
            'diamonds': 'diamonds',
            'clubs': 'clubs',
            'spades': 'spades',
            'hearts': 'hearts',
            'diamonds': 'diamonds',
            'clubs': 'clubs',
            'hot': 'hot',
            'note': 'note',
            'note': 'note',
            'notes': 'notes',
            'notes': 'notes',
            'flat': 'flat',
            'natural': 'natural',
            'sharp': 'sharp',
            'cross': 'cross',
            'cross': 'cross',
            'recycle': 'recycle',
            'recycle': 'recycle',
            'recycle': 'recycle',
            'recycle': 'recycle',
            'recycle': 'recycle',
            'recycle': 'recycle',
            'recycle': 'recycle',
            'recycle': 'recycle',
            'recycle': 'recycle',
            'recycle': 'recycle',
            'recycle': 'recycle',
            'recycle': 'recycle',
            'recycle': 'recycle',
            'wheelchair': 'wheelchair',
            'die1': 'die1',
            'die2': 'die2',
            'die3': 'die3',
            'die4': 'die4',
            'die5': 'die5',
            'die6': 'die6',
            'white': 'white',
            'black': 'black',
            'white': 'white',
            'black': 'black',
            'yang': 'yang',
            'yin': 'yin',
            'yang': 'yang',
            'yin': 'yin',
            'yang': 'yang',
            'yin': 'yin',
            'white': 'white',
            'black': 'black',
            'hammer': 'hammer',
            'anchor': 'anchor',
            'swords': 'swords',
            'medical': 'medical',
            'scales': 'scales',
            'alembic': 'alembic',
            'flower': 'flower',
            'gear': 'gear',
            'staff': 'staff',
            'atom': 'atom',
            'fleur': 'fleur',
            'star': 'star',
            'star': 'star',
            'star': 'star',
            'WARNING': 'WARNING',
            'lightning': 'lightning',
            'female': 'female',
            'male': 'male',
            'male-female': 'male-female',
            'male-female': 'male-female',
            'male': 'male',
            'transgender': 'transgender',
            'male': 'male',
            'female': 'female',
            'white': 'white',
            'black': 'black',
            'white': 'white',
            'marriage': 'marriage',
            'divorce': 'divorce',
            'partnership': 'partnership',
            'coffin': 'coffin',
            'urn': 'urn',
            'male': 'male',
            'ceres': 'ceres',
            'pallas': 'pallas',
            'juno': 'juno',
            'vesta': 'vesta',
            'chiron': 'chiron',
            'lilith': 'lilith',
            'sextile': 'sextile',
            'semisextile': 'semisextile',
            'quincunx': 'quincunx',
            'sesquiquadrate': 'sesquiquadrate',
            'soccer': 'soccer',
            'baseball': 'baseball',
            'squatting': 'squatting',
            'white': 'white',
            'black': 'black',
            'white': 'white',
            'black': 'black',
            'snowman': 'snowman',
            'cloud': 'cloud',
            'rain': 'rain',
            'snow': 'snow',
            'storm': 'storm',
            'umbrella': 'umbrella',
            'hot': 'hot',
            'cold': 'cold',
            'no': 'no',
            'no': 'no',
            'ophiuchus': 'ophiuchus',
            'pick': 'pick',
            'car': 'car',
            'helmet': 'helmet',
            'chains': 'chains',
            'chains': 'chains',
            'no': 'no',
            'no': 'no',
            'no': 'no',
            'no': 'no',
            'no': 'no',
            'no': 'no',
            'no': 'no',
            'no': 'no',
            'no': 'no',
            'no': 'no',
            'no': 'no',
            'no': 'no',
            'construction': 'construction',
            'no': 'no',
            'uranus': 'uranus',
            'anchor': 'anchor',
            'cross': 'cross',
            'cross': 'cross',
            'cross': 'cross',
            'cross': 'cross',
            'cross': 'cross',
            'shrine': 'shrine',
            'church': 'church',
            'castle': 'castle',
            'historic': 'historic',
            'gear': 'gear',
            'gear': 'gear',
            'gear': 'gear',
            'mountain': 'mountain',
            'umbrella': 'umbrella',
            'fountain': 'fountain',
            'flag': 'flag',
            'ferry': 'ferry',
            'sailboat': 'sailboat',
            'boat': 'boat',
            'skier': 'skier',
            'skate': 'skate',
            'basketball': 'basketball',
            'tent': 'tent',
            'railway': 'railway',
            'railway': 'railway',
            'fuel': 'fuel',
            'fuel': 'fuel',
            'fuel': 'fuel',
            'scissors': 'scissors',
            'scissors': 'scissors',
            'scissors': 'scissors',
            'scissors': 'scissors',
            'scissors': 'scissors',
            '': '',
            'phone': 'phone',
            'tape': 'tape',
            'plane': 'plane',
            'mail': 'mail',
            'fist': 'fist',
            'hand': 'hand',
            'peace': 'peace',
            'writing': 'writing',
            'pencil': 'pencil',
            'pencil': 'pencil',
            'pencil': 'pencil',
            'pencil': 'pencil',
            'pen': 'pen',
            '': '',
            '': '',
            'x': 'x',
            'x': 'x',
            'x': 'x',
            'x': 'x',
            'cross': 'cross',
            'cross': 'cross',
            'cross': 'cross',
            'cross': 'cross',
            'cross': 'cross',
            'cross': 'cross',
            'cross': 'cross',
            'cross': 'cross',
            'star': 'star',
            'star': 'star',
            'star': 'star',
            'star': 'star',
            'star': 'star',
            'star': 'star',
            'star': 'star',
            'sparkles': 'sparkles',
            'star': 'star',
            'star': 'star',
            'star': 'star',
            'star': 'star',
            'star': 'star',
            'star': 'star',
            'star': 'star',
            'star': 'star',
            'asterisk': 'asterisk',
            'asterisk': 'asterisk',
            'asterisk': 'asterisk',
            'asterisk': 'asterisk',
            'asterisk': 'asterisk',
            'asterisk': 'asterisk',
            'asterisk': 'asterisk',
            'asterisk': 'asterisk',
            'asterisk': 'asterisk',
            'asterisk': 'asterisk',
            'asterisk': 'asterisk',
            'asterisk': 'asterisk',
            'asterisk': 'asterisk',
            'asterisk': 'asterisk',
            'flower': 'flower',
            'flower': 'flower',
            'flower': 'flower',
            'flower': 'flower',
            'flower': 'flower',
            'snowflake': 'snowflake',
            'snowflake': 'snowflake',
            'snowflake': 'snowflake',
            'sparkle': 'sparkle',
            'sparkle': 'sparkle',
            'sparkle': 'sparkle',
            'sparkle': 'sparkle',
            'sparkle': 'sparkle',
            '': '',
            'circle': 'circle',
            '': '',
            'square': 'square',
            'square': 'square',
            'square': 'square',
            'square': 'square',
            '?': '?',
            '?': '?',
            '!': '!',
            'diamond': 'diamond',
            '!': '!',
            '|': '|',
            '|': '|',
            '|': '|',
            ''': "'",
            ''': "'",
            '"': '"',
            '"': '"',
            ',': ',',
            ',': ',',
            '.': '.',
            '!': '!',
            '!': '!',
            '<3': '<3',
            '<3': '<3',
            '<3': '<3',
            '<3': '<3',
            '(': '(',
            ')': ')',
            '(': '(',
            ')': ')',
            '<': '<',
            '>': '>',
            '<': '<',
            '>': '>',
            '{': '{',
            '}': '}',
            '[': '[',
            ']': ']',
            '{': '{',
            '}': '}',
            '1': '1',
            '2': '2',
            '3': '3',
            '4': '4',
            '5': '5',
            '6': '6',
            '7': '7',
            '8': '8',
            '9': '9',
            '10': '10',
            '1': '1',
            '2': '2',
            '3': '3',
            '4': '4',
            '5': '5',
            '6': '6',
            '7': '7',
            '8': '8',
            '9': '9',
            '10': '10',
            '1': '1',
            '2': '2',
            '3': '3',
            '4': '4',
            '5': '5',
            '6': '6',
            '7': '7',
            '8': '8',
            '9': '9',
            '10': '10',
            '->': '->',
            '+': '+',
            '-': '-',
            '/': '/',
            '->': '->',
            '->': '->',
            '->': '->',
            '->': '->',
            '->': '->',
            '->': '->',
            '->': '->',
            '->': '->',
            '->': '->',
            '->': '->',
            '->': '->',
            '->': '->',
            '->': '->',
            '->': '->',
            '->': '->',
            '->': '->',
            '->': '->',
            '->': '->',
            '->': '->',
            '->': '->',
            '->': '->',
            '->': '->',
            '->': '->',
            '->': '->',
            '~': '~',
            '->': '->',
            '->': '->',
            '->': '->',
            '->': '->',
            '->': '->',
            '->': '->',
            '->': '->',
            '->': '->',
            '->': '->',
            '->': '->',
            '->': '->',
            '->': '->',
            '->': '->',
            '->': '->',
            '->': '->',
        }
        
        # Apply replacements
        original_content = content
        for unicode_char, replacement in unicode_replacements.items():
            content = content.replace(unicode_char, replacement)
        
        # Only write if changes were made
        if content != original_content:
            with open(file_path, 'w', encoding='utf-8') as f:
                f.write(content)
            print(f"Fixed Unicode in: {file_path}")
            return True
        
        return False
        
    except Exception as e:
        print(f"Error processing {file_path}: {e}")
        return False

def fix_unicode_in_directory(directory):
    """Fix Unicode characters in all Python files in a directory"""
    fixed_count = 0
    total_count = 0
    
    for root, dirs, files in os.walk(directory):
        for file in files:
            if file.endswith(('.py', '.sh', '.ps1', '.bat', '.yaml', '.yml', '.md')):
                file_path = os.path.join(root, file)
                total_count += 1
                if fix_unicode_in_file(file_path):
                    fixed_count += 1
    
    return fixed_count, total_count

def main():
    """Main function"""
    print("CodeGrey AI SOC Platform - Unicode Fix Script")
    print("=" * 50)
    
    # Get the current directory (clean folder)
    current_dir = Path(__file__).parent
    
    print(f"Scanning directory: {current_dir}")
    print("Looking for Unicode characters in Python, shell, and config files...")
    print()
    
    # Fix Unicode in the entire directory
    fixed_count, total_count = fix_unicode_in_directory(current_dir)
    
    print()
    print("=" * 50)
    print(f"Unicode fix completed!")
    print(f"Files processed: {total_count}")
    print(f"Files fixed: {fixed_count}")
    print(f"Files unchanged: {total_count - fixed_count}")
    
    if fixed_count > 0:
        print()
        print("All Unicode characters have been removed or replaced with ASCII equivalents.")
        print("The codebase should now be compatible with all encoding systems.")
    
    return 0

if __name__ == "__main__":
    sys.exit(main())

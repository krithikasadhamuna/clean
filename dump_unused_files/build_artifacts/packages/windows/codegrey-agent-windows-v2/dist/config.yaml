client:
  agent_id: auto
  server_endpoint: http://127.0.0.1:8081
  api_key: ""
  reconnect_interval: 30
  heartbeat_interval: 60

log_forwarding:
  enabled: true
  batch_size: 100
  flush_interval: 30
  compression: true
  sources:
  - windows_events
  - process_monitor
  - network_monitor
  - file_monitor
  - container_logs

log_sources:
  system_logs:
    enabled: true
    priority: "high"
  security_logs:
    enabled: true
    priority: "critical"
  application_logs:
    enabled: true
    priority: "medium"
  attack_logs:
    enabled: true
    priority: "critical"
  container_logs:
    enabled: true
    priority: "high"

windows:
  event_logs:
    - "Security"
    - "System" 
    - "Application"
    - "Microsoft-Windows-Sysmon/Operational"
    - "Microsoft-Windows-PowerShell/Operational"
    - "Microsoft-Windows-Windows Defender/Operational"
  wmi_enabled: true

command_execution:
  enabled: true
  allowed_commands:
  - powershell
  - cmd
  - docker
  - bash
  timeout: 300

# Enhanced container management with full capabilities
containers:
  enabled: true
  docker_required: true
  max_containers: 10
  auto_cleanup: true
  cleanup_after_hours: 24
  preserve_golden_images: true
  log_forwarding: true
  
  # Container templates for different attack scenarios
  templates:
    windows_endpoint:
      image: "mcr.microsoft.com/windows/servercore:ltsc2019"
      platform: "windows"
      memory_limit: "2g"
      cpu_limit: "1.0"
      
    linux_server:
      image: "ubuntu:22.04"
      platform: "linux"
      memory_limit: "1g"
      cpu_limit: "0.5"
      
    web_application:
      image: "nginx:alpine"
      platform: "linux"
      memory_limit: "512m"
      cpu_limit: "0.3"
      
    database_server:
      image: "mysql:8.0"
      platform: "linux"
      memory_limit: "1g"
      cpu_limit: "0.5"

# Container attack execution settings
container_attack_execution:
  enabled: true
  max_concurrent_attacks: 5
  attack_timeout_minutes: 30
  preserve_attack_containers: false
  create_golden_images: true
  log_all_attacks: true

# Golden image management
golden_images:
  enabled: true
  storage_path: "./golden_images"
  max_images: 50
  auto_cleanup: true
  cleanup_after_days: 30

# Container networking
container_networking:
  enabled: true
  network_mode: "bridge"
  create_isolated_networks: true
  allow_host_network: false
  port_mapping: true

# Container security
container_security:
  enabled: true
  read_only_root_filesystem: false
  no_new_privileges: true
  drop_capabilities: true
  security_opt: ["no-new-privileges:true"]

# Performance settings
performance:
  max_memory_mb: 2048
  max_cpu_percent: 50
  queue_size: 10000
  container_memory_limit: "2g"
  container_cpu_limit: "1.0"

security:
  api_key_required: false
  encryption_enabled: false
  command_validation: true
  container_isolation: true
  attack_simulation_mode: true

logging:
  level: INFO
  file: codegrey-agent.log
  max_size_mb: 100
  backup_count: 5
  container_logs: true
  attack_execution_logs: true
  golden_image_logs: true

# Development and testing
development:
  mock_data_enabled: false
  test_mode: false
  debug_networking: false
  simulate_threats: true
  container_debug: false
